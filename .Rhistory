geom_bar(aes(x = "aware_alittle", y = aware_alittle, fill = affected), stat = "identity", position = "dodge") +
geom_bar(aes(x = "aware_moderate", y = aware_moderate, fill = affected), stat = "identity", position = "dodge") +
geom_bar(aes(x = "aware_alot", y = aware_alot, fill = affected), stat = "identity", position = "dodge") +
geom_bar(aes(x = "aware_refuse", y = aware_refuse, fill = affected), stat = "identity", position = "dodge") +
labs(x = "Awareness Categories", y = "Value", title = "Comparison of Awareness Levels") +
scale_x_discrete(labels = c("aware_no" = "No", "aware_alittle" = "A Little", "aware_moderate" = "Moderate",
"aware_alot" = "A Lot", "aware_refuse" = "Refuse")) +
theme_minimal()
# This is an example of how you can control figures and captions in
# an R chunk. Note that you can reference figures using:
# \@ref(fig:insight1), where "insight1" is the label of this code
# chunk (the first bit of text after the "r" in "```{r label, options...}")
world_map <- map_data("world")
ggplot() +
geom_polygon(data = world_map, aes(x = long, y = lat, group = group), fill = "lightgray", color = "white") +
# hurricanes +-5 of equator are extremely rare
geom_rect(aes(xmin = -180, xmax = 180, ymin = -5, ymax = 5), fill = "red", alpha = 0.2) +
geom_hex(data = cyclones_data, aes(x = long, y = lat, fill = category), bins = 50, alpha = 0.7) +
scale_fill_viridis_d(name = "Storm Category") +
labs(
title = "North Atlantic and Northeast Pacific Cyclones by Category",
x = "Longitude",
y = "Latitude"
) +
scale_x_continuous(breaks = c(-180, -90, 0, 90, 180)) +
scale_y_continuous(breaks = c(-90, -45, 0, 45, 90)) +
theme_minimal()
cyclone_affected <- climate_awareness |>
filter(country %in% countries_with_cyclone$country) |>
left_join(countries_with_cyclone, by = "country") |>
rename(cyclone_count = count) |>
mutate(affected = "Affected")
# Weight the cyclone_affected data by cyclone_count for each awareness level
weighted_cyclone_affected <- cyclone_affected |>
summarise(
aware_no = sum(aware_no * cyclone_count) / sum(cyclone_count),
aware_alittle = sum(aware_alittle * cyclone_count) / sum(cyclone_count),
aware_moderate = sum(aware_moderate * cyclone_count) / sum(cyclone_count),
aware_alot = sum(aware_alot * cyclone_count) / sum(cyclone_count),
aware_refuse = sum(aware_refuse * cyclone_count) / sum(cyclone_count)
)
cyclone_unaffected <- climate_awareness |>
filter(country %in% countries_without_cyclone$country) |>
mutate(affected = "Unaffected")
world_cyclone <- bind_rows(
weighted_cyclone_affected |>
mutate(affected = "Affected"),
cyclone_unaffected |>
summarise(across(where(is.numeric), mean, na.rm = TRUE)) |>
mutate(affected = "Unaffected")
)
# This is an example of how you can control figures and captions in
# an R chunk. Note that you can reference figures using:
# \@ref(fig:insight1), where "insight1" is the label of this code
# chunk (the first bit of text after the "r" in "```{r label, options...}")
world_map <- map_data("world")
ggplot() +
geom_polygon(data = world_map, aes(x = long, y = lat, group = group), fill = "lightgray", color = "white") +
# hurricanes +-5 of equator are extremely rare
geom_rect(aes(xmin = -180, xmax = 180, ymin = -5, ymax = 5), fill = "red", alpha = 0.2) +
geom_hex(data = cyclones_data, aes(x = long, y = lat, fill = category), bins = 50, alpha = 0.7) +
scale_fill_viridis_d(name = "Storm Category") +
labs(
title = "North Atlantic and Northeast Pacific Cyclones by Category",
x = "Longitude",
y = "Latitude"
) +
scale_x_continuous(breaks = c(-180, -90, 0, 90, 180)) +
scale_y_continuous(breaks = c(-90, -45, 0, 45, 90)) +
theme_minimal()
cyclone_affected <- climate_awareness |>
filter(country %in% countries_with_cyclone$country) |>
left_join(countries_with_cyclone, by = "country") |>
rename(cyclone_count = count) |>
mutate(affected = "Affected")
# Weight the cyclone_affected data by cyclone_count for each awareness level
weighted_cyclone_affected <- cyclone_affected |>
summarise(
aware_no = sum(aware_no * cyclone_count) / sum(cyclone_count),
aware_alittle = sum(aware_alittle * cyclone_count) / sum(cyclone_count),
aware_moderate = sum(aware_moderate * cyclone_count) / sum(cyclone_count),
aware_alot = sum(aware_alot * cyclone_count) / sum(cyclone_count),
aware_refuse = sum(aware_refuse * cyclone_count) / sum(cyclone_count)
)
cyclone_unaffected <- climate_awareness |>
filter(country %in% countries_without_cyclone$country) |>
mutate(affected = "Unaffected")
(world_cyclone <- bind_rows(
weighted_cyclone_affected |>
mutate(affected = "Affected"),
cyclone_unaffected |>
summarise(across(where(is.numeric), mean, na.rm = TRUE)) |>
mutate(affected = "Unaffected")
))
# This is an example of how you can control figures and captions in
# an R chunk. Note that you can reference figures using:
# \@ref(fig:insight1), where "insight1" is the label of this code
# chunk (the first bit of text after the "r" in "```{r label, options...}")
world_map <- map_data("world")
ggplot() +
geom_polygon(data = world_map, aes(x = long, y = lat, group = group), fill = "lightgray", color = "white") +
# hurricanes +-5 of equator are extremely rare
geom_rect(aes(xmin = -180, xmax = 180, ymin = -5, ymax = 5), fill = "red", alpha = 0.2) +
geom_hex(data = cyclones_data, aes(x = long, y = lat, fill = category), bins = 50, alpha = 0.7) +
scale_fill_viridis_d(name = "Storm Category") +
labs(
title = "North Atlantic and Northeast Pacific Cyclones by Category",
x = "Longitude",
y = "Latitude"
) +
scale_x_continuous(breaks = c(-180, -90, 0, 90, 180)) +
scale_y_continuous(breaks = c(-90, -45, 0, 45, 90)) +
theme_minimal()
cyclone_affected <- climate_awareness |>
filter(country %in% countries_with_cyclone$country) |>
left_join(countries_with_cyclone, by = "country") |>
rename(cyclone_count = count) |>
mutate(affected = "Affected")
# Weight the cyclone_affected data by cyclone_count for each awareness level
weighted_cyclone_affected <- cyclone_affected |>
summarise(
aware_no = sum(aware_no * cyclone_count) / sum(cyclone_count),
aware_alittle = sum(aware_alittle * cyclone_count) / sum(cyclone_count),
aware_moderate = sum(aware_moderate * cyclone_count) / sum(cyclone_count),
aware_alot = sum(aware_alot * cyclone_count) / sum(cyclone_count),
aware_refuse = sum(aware_refuse * cyclone_count) / sum(cyclone_count)
)
cyclone_unaffected <- climate_awareness |>
filter(country %in% countries_without_cyclone$country) |>
mutate(affected = "Unaffected")
(world_cyclone <- bind_rows(
weighted_cyclone_affected |>
mutate(affected = "Affected"),
cyclone_unaffected |>
summarise(across(where(is.numeric), mean, na.rm = TRUE)) |>
mutate(affected = "Unaffected")
))
world_cyclone_long <- world_cyclone %>%
pivot_longer(cols = starts_with("aware"), names_to = "awareness_level", values_to = "value")
ggplot(world_cyclone_long, aes(x = affected, y = value, fill = awareness_level)) +
geom_bar(stat = "identity", position = "dodge") +
labs(x = "Cyclone Impact", y = "Awareness Level", fill = "Awareness Category",
title = "Comparison of Awareness Levels Between Cyclone-Affected and Unaffected") +
theme_minimal()
# This is an example of how you can control figures and captions in
# an R chunk. Note that you can reference figures using:
# \@ref(fig:insight1), where "insight1" is the label of this code
# chunk (the first bit of text after the "r" in "```{r label, options...}")
world_map <- map_data("world")
ggplot() +
geom_polygon(data = world_map, aes(x = long, y = lat, group = group), fill = "lightgray", color = "white") +
# hurricanes +-5 of equator are extremely rare
geom_rect(aes(xmin = -180, xmax = 180, ymin = -5, ymax = 5), fill = "red", alpha = 0.2) +
geom_hex(data = cyclones_data, aes(x = long, y = lat, fill = category), bins = 50, alpha = 0.7) +
scale_fill_viridis_d(name = "Storm Category") +
labs(
title = "North Atlantic and Northeast Pacific Cyclones by Category",
x = "Longitude",
y = "Latitude"
) +
scale_x_continuous(breaks = c(-180, -90, 0, 90, 180)) +
scale_y_continuous(breaks = c(-90, -45, 0, 45, 90)) +
theme_minimal()
cyclone_affected <- climate_awareness |>
filter(country %in% countries_with_cyclone$country) |>
left_join(countries_with_cyclone, by = "country") |>
rename(cyclone_count = count) |>
mutate(affected = "Affected")
# Weight the cyclone_affected data by cyclone_count for each awareness level
weighted_cyclone_affected <- cyclone_affected |>
summarise(
aware_no = sum(aware_no * cyclone_count) / sum(cyclone_count),
aware_alittle = sum(aware_alittle * cyclone_count) / sum(cyclone_count),
aware_moderate = sum(aware_moderate * cyclone_count) / sum(cyclone_count),
aware_alot = sum(aware_alot * cyclone_count) / sum(cyclone_count),
aware_refuse = sum(aware_refuse * cyclone_count) / sum(cyclone_count)
)
cyclone_unaffected <- climate_awareness |>
filter(country %in% countries_without_cyclone$country) |>
mutate(affected = "Unaffected")
(world_cyclone <- bind_rows(
weighted_cyclone_affected |>
mutate(affected = "Affected"),
cyclone_unaffected |>
summarise(across(where(is.numeric), mean, na.rm = TRUE)) |>
mutate(affected = "Unaffected")
))
world_cyclone_long <- world_cyclone %>%
pivot_longer(cols = c(aware_no, aware_alittle, aware_moderate, aware_alot, aware_refuse),
names_to = "awareness_level", values_to = "value")
ggplot(world_cyclone_long, aes(x = affected, y = value, fill = awareness_level)) +
geom_bar(stat = "identity", position = "dodge") +
labs(x = "Cyclone Impact", y = "Awareness Level", fill = "Awareness Category",
title = "Comparison of Awareness Levels Between Cyclone-Affected and Unaffected") +
theme_minimal()
# This is an example of how you can control figures and captions in
# an R chunk. Note that you can reference figures using:
# \@ref(fig:insight1), where "insight1" is the label of this code
# chunk (the first bit of text after the "r" in "```{r label, options...}")
world_map <- map_data("world")
ggplot() +
geom_polygon(data = world_map, aes(x = long, y = lat, group = group), fill = "lightgray", color = "white") +
# hurricanes +-5 of equator are extremely rare
geom_rect(aes(xmin = -180, xmax = 180, ymin = -5, ymax = 5), fill = "red", alpha = 0.2) +
geom_hex(data = cyclones_data, aes(x = long, y = lat, fill = category), bins = 50, alpha = 0.7) +
scale_fill_viridis_d(name = "Storm Category") +
labs(
title = "North Atlantic and Northeast Pacific Cyclones by Category",
x = "Longitude",
y = "Latitude"
) +
scale_x_continuous(breaks = c(-180, -90, 0, 90, 180)) +
scale_y_continuous(breaks = c(-90, -45, 0, 45, 90)) +
theme_minimal()
cyclone_affected <- climate_awareness |>
filter(country %in% countries_with_cyclone$country) |>
left_join(countries_with_cyclone, by = "country") |>
rename(cyclone_count = count) |>
mutate(affected = "Affected")
# Weight the cyclone_affected data by cyclone_count for each awareness level
weighted_cyclone_affected <- cyclone_affected |>
summarise(
aware_no = sum(aware_no * cyclone_count) / sum(cyclone_count),
aware_alittle = sum(aware_alittle * cyclone_count) / sum(cyclone_count),
aware_moderate = sum(aware_moderate * cyclone_count) / sum(cyclone_count),
aware_alot = sum(aware_alot * cyclone_count) / sum(cyclone_count),
aware_refuse = sum(aware_refuse * cyclone_count) / sum(cyclone_count)
)
cyclone_unaffected <- climate_awareness |>
filter(country %in% countries_without_cyclone$country) |>
mutate(affected = "Unaffected")
(world_cyclone <- bind_rows(
weighted_cyclone_affected |>
mutate(affected = "Affected"),
cyclone_unaffected |>
summarise(across(where(is.numeric), mean, na.rm = TRUE)) |>
mutate(affected = "Unaffected")
))
world_cyclone_long <- world_cyclone %>%
pivot_longer(cols = c(aware_no, aware_alittle, aware_moderate, aware_alot, aware_refuse),
names_to = "awareness_level", values_to = "value")
ggplot(world_cyclone_long, aes(x = awareness_level, y = value, fill = affected)) +
geom_bar(stat = "identity", position = "dodge") +
labs(x = "Awareness Category", y = "Awareness Level", fill = "Cyclone Impact",
title = "Comparison of Awareness Levels Between Cyclone-Affected and Unaffected") +
theme_minimal() +
scale_fill_manual(values = c("Affected" = "blue", "Unaffected" = "red"))  # Choose any two colors for differentiation
# This is an example of how you can control figures and captions in
# an R chunk. Note that you can reference figures using:
# \@ref(fig:insight1), where "insight1" is the label of this code
# chunk (the first bit of text after the "r" in "```{r label, options...}")
world_map <- map_data("world")
ggplot() +
geom_polygon(data = world_map, aes(x = long, y = lat, group = group), fill = "lightgray", color = "white") +
# hurricanes +-5 of equator are extremely rare
geom_rect(aes(xmin = -180, xmax = 180, ymin = -5, ymax = 5), fill = "red", alpha = 0.2) +
geom_hex(data = cyclones_data, aes(x = long, y = lat, fill = category), bins = 50, alpha = 0.7) +
scale_fill_viridis_d(name = "Storm Category") +
labs(
title = "North Atlantic and Northeast Pacific Cyclones by Category",
x = "Longitude",
y = "Latitude"
) +
scale_x_continuous(breaks = c(-180, -90, 0, 90, 180)) +
scale_y_continuous(breaks = c(-90, -45, 0, 45, 90)) +
theme_minimal()
cyclone_affected <- climate_awareness |>
filter(country %in% countries_with_cyclone$country) |>
left_join(countries_with_cyclone, by = "country") |>
rename(cyclone_count = count) |>
mutate(affected = "Affected")
# Weight the cyclone_affected data by cyclone_count for each awareness level
weighted_cyclone_affected <- cyclone_affected |>
summarise(
aware_no = sum(aware_no * cyclone_count) / sum(cyclone_count),
aware_alittle = sum(aware_alittle * cyclone_count) / sum(cyclone_count),
aware_moderate = sum(aware_moderate * cyclone_count) / sum(cyclone_count),
aware_alot = sum(aware_alot * cyclone_count) / sum(cyclone_count),
aware_refuse = sum(aware_refuse * cyclone_count) / sum(cyclone_count)
)
cyclone_unaffected <- climate_awareness |>
filter(country %in% countries_without_cyclone$country) |>
mutate(affected = "Unaffected")
(world_cyclone <- bind_rows(
weighted_cyclone_affected |>
mutate(affected = "Affected"),
cyclone_unaffected |>
summarise(across(where(is.numeric), mean, na.rm = TRUE)) |>
mutate(affected = "Unaffected")
))
world_cyclone_long <- world_cyclone %>%
pivot_longer(cols = c(aware_no, aware_alittle, aware_moderate, aware_alot, aware_refuse),
names_to = "awareness_level", values_to = "value")
ggplot(world_cyclone_long, aes(x = awareness_level, y = value, fill = affected)) +
geom_bar(stat = "identity", position = "dodge") +
labs(x = "Awareness Category", y = "Awareness Level", fill = "Cyclone Impact",
title = "Comparison of Awareness Levels Between Cyclone-Affected and Unaffected") +
theme_minimal() +
# This is an example of how you can control figures and captions in
# an R chunk. Note that you can reference figures using:
# \@ref(fig:insight1), where "insight1" is the label of this code
# chunk (the first bit of text after the "r" in "```{r label, options...}")
world_map <- map_data("world")
ggplot() +
geom_polygon(data = world_map, aes(x = long, y = lat, group = group), fill = "lightgray", color = "white") +
# hurricanes +-5 of equator are extremely rare
geom_rect(aes(xmin = -180, xmax = 180, ymin = -5, ymax = 5), fill = "red", alpha = 0.2) +
geom_hex(data = cyclones_data, aes(x = long, y = lat, fill = category), bins = 50, alpha = 0.7) +
scale_fill_viridis_d(name = "Storm Category") +
labs(
title = "North Atlantic and Northeast Pacific Cyclones by Category",
x = "Longitude",
y = "Latitude"
) +
scale_x_continuous(breaks = c(-180, -90, 0, 90, 180)) +
scale_y_continuous(breaks = c(-90, -45, 0, 45, 90)) +
theme_minimal()
cyclone_affected <- climate_awareness |>
filter(country %in% countries_with_cyclone$country) |>
left_join(countries_with_cyclone, by = "country") |>
rename(cyclone_count = count) |>
mutate(affected = "Affected")
# Weight the cyclone_affected data by cyclone_count for each awareness level
weighted_cyclone_affected <- cyclone_affected |>
summarise(
aware_no = sum(aware_no * cyclone_count) / sum(cyclone_count),
aware_alittle = sum(aware_alittle * cyclone_count) / sum(cyclone_count),
aware_moderate = sum(aware_moderate * cyclone_count) / sum(cyclone_count),
aware_alot = sum(aware_alot * cyclone_count) / sum(cyclone_count),
aware_refuse = sum(aware_refuse * cyclone_count) / sum(cyclone_count)
)
cyclone_unaffected <- climate_awareness |>
filter(country %in% countries_without_cyclone$country) |>
mutate(affected = "Unaffected")
(world_cyclone <- bind_rows(
weighted_cyclone_affected |>
mutate(affected = "Affected"),
cyclone_unaffected |>
summarise(across(where(is.numeric), mean, na.rm = TRUE)) |>
mutate(affected = "Unaffected")
))
world_cyclone_long <- world_cyclone %>%
pivot_longer(cols = c(aware_no, aware_alittle, aware_moderate, aware_alot, aware_refuse),
names_to = "awareness_level", values_to = "value")
ggplot(world_cyclone_long, aes(x = awareness_level, y = value, fill = affected)) +
geom_bar(stat = "identity", position = "dodge") +
labs(x = "Awareness Category", y = "Awareness Level", fill = "Cyclone Impact",
title = "Comparison of Awareness Levels Between Cyclone-Affected and Unaffected") +
theme_minimal()
# This is an example of how you can control figures and captions in
# an R chunk. Note that you can reference figures using:
# \@ref(fig:insight1), where "insight1" is the label of this code
# chunk (the first bit of text after the "r" in "```{r label, options...}")
world_map <- map_data("world")
ggplot() +
geom_polygon(data = world_map, aes(x = long, y = lat, group = group), fill = "lightgray", color = "white") +
# hurricanes +-5 of equator are extremely rare
geom_rect(aes(xmin = -180, xmax = 180, ymin = -5, ymax = 5), fill = "red", alpha = 0.2) +
geom_hex(data = cyclones_data, aes(x = long, y = lat, fill = category), bins = 50, alpha = 0.7) +
scale_fill_viridis_d(name = "Storm Category") +
labs(
title = "North Atlantic and Northeast Pacific Cyclones by Category",
x = "Longitude",
y = "Latitude"
) +
scale_x_continuous(breaks = c(-180, -90, 0, 90, 180)) +
scale_y_continuous(breaks = c(-90, -45, 0, 45, 90)) +
theme_minimal()
cyclone_affected <- climate_awareness |>
filter(country %in% countries_with_cyclone$country) |>
left_join(countries_with_cyclone, by = "country") |>
rename(cyclone_count = count) |>
mutate(affected = "Affected")
# Weight the cyclone_affected data by cyclone_count for each awareness level
weighted_cyclone_affected <- cyclone_affected |>
summarise(
aware_no = sum(aware_no * cyclone_count) / sum(cyclone_count),
aware_alittle = sum(aware_alittle * cyclone_count) / sum(cyclone_count),
aware_moderate = sum(aware_moderate * cyclone_count) / sum(cyclone_count),
aware_alot = sum(aware_alot * cyclone_count) / sum(cyclone_count),
aware_refuse = sum(aware_refuse * cyclone_count) / sum(cyclone_count)
)
cyclone_unaffected <- climate_awareness |>
filter(country %in% countries_without_cyclone$country) |>
mutate(affected = "Unaffected")
(world_cyclone <- bind_rows(
weighted_cyclone_affected |>
mutate(affected = "Affected"),
cyclone_unaffected |>
summarise(across(where(is.numeric), mean, na.rm = TRUE)) |>
mutate(affected = "Unaffected")
))
world_cyclone_long <- world_cyclone %>%
pivot_longer(cols = c(aware_no, aware_alittle, aware_moderate, aware_alot, aware_refuse),
names_to = "awareness_level", values_to = "value")
world_cyclone_long$awareness_level <- factor(world_cyclone_long$awareness_level,
levels = c("aware_alot", "aware_moderate", "aware_alittle", "aware_no", "aware_refuse"),
labels = c("Aware", "Moderately Aware", "Aware a Little", "Not Aware", "Refuse"))
ggplot(world_cyclone_long, aes(x = awareness_level, y = value, fill = affected)) +
geom_bar(stat = "identity", position = "dodge") +
labs(x = "Awareness Category", y = "Awareness Level", fill = "Cyclone Impact",
title = "Comparison of Awareness Levels Between Cyclone-Affected and Unaffected") +
theme_minimal() +
scale_fill_manual(values = c("Affected" = "blue", "Unaffected" = "red"))  # Choose any two colors for differentiation
# This is an example of how you can control figures and captions in
# an R chunk. Note that you can reference figures using:
# \@ref(fig:insight1), where "insight1" is the label of this code
# chunk (the first bit of text after the "r" in "```{r label, options...}")
world_map <- map_data("world")
ggplot() +
geom_polygon(data = world_map, aes(x = long, y = lat, group = group), fill = "lightgray", color = "white") +
# hurricanes +-5 of equator are extremely rare
geom_rect(aes(xmin = -180, xmax = 180, ymin = -5, ymax = 5), fill = "red", alpha = 0.2) +
geom_hex(data = cyclones_data, aes(x = long, y = lat, fill = category), bins = 50, alpha = 0.7) +
scale_fill_viridis_d(name = "Storm Category") +
labs(
title = "North Atlantic and Northeast Pacific Cyclones by Category",
x = "Longitude",
y = "Latitude"
) +
scale_x_continuous(breaks = c(-180, -90, 0, 90, 180)) +
scale_y_continuous(breaks = c(-90, -45, 0, 45, 90)) +
theme_minimal()
cyclone_affected <- climate_awareness |>
filter(country %in% countries_with_cyclone$country) |>
left_join(countries_with_cyclone, by = "country") |>
rename(cyclone_count = count) |>
mutate(affected = "Affected")
# Weight the cyclone_affected data by cyclone_count for each awareness level
weighted_cyclone_affected <- cyclone_affected |>
summarise(
aware_no = sum(aware_no * cyclone_count) / sum(cyclone_count),
aware_alittle = sum(aware_alittle * cyclone_count) / sum(cyclone_count),
aware_moderate = sum(aware_moderate * cyclone_count) / sum(cyclone_count),
aware_alot = sum(aware_alot * cyclone_count) / sum(cyclone_count),
aware_refuse = sum(aware_refuse * cyclone_count) / sum(cyclone_count)
)
cyclone_unaffected <- climate_awareness |>
filter(country %in% countries_without_cyclone$country) |>
mutate(affected = "Unaffected")
(world_cyclone <- bind_rows(
weighted_cyclone_affected |>
mutate(affected = "Affected"),
cyclone_unaffected |>
summarise(across(where(is.numeric), mean, na.rm = TRUE)) |>
mutate(affected = "Unaffected")
))
world_cyclone_long <- world_cyclone %>%
pivot_longer(cols = c(aware_no, aware_alittle, aware_moderate, aware_alot, aware_refuse),
names_to = "awareness_level", values_to = "value") %>%
mutate(awareness_level = factor(awareness_level,
levels = c("aware_alot", "aware_moderate", "aware_alittle", "aware_no", "aware_refuse"),
labels = c("Aware", "Moderately Aware", "Aware a Little", "Not Aware", "Refuse")))
ggplot(world_cyclone_long, aes(x = awareness_level, y = value, fill = affected)) +
geom_bar(stat = "identity", position = "dodge") +
labs(x = "Awareness Category", y = "Awareness Level", fill = "Cyclone Impact",
title = "Comparison of Awareness Levels Between Cyclone-Affected and Unaffected") +
theme_minimal()
# This is an example of how you can control figures and captions in
# an R chunk. Note that you can reference figures using:
# \@ref(fig:insight1), where "insight1" is the label of this code
# chunk (the first bit of text after the "r" in "```{r label, options...}")
world_map <- map_data("world")
ggplot() +
geom_polygon(data = world_map, aes(x = long, y = lat, group = group), fill = "lightgray", color = "white") +
# hurricanes +-5 of equator are extremely rare
geom_rect(aes(xmin = -180, xmax = 180, ymin = -5, ymax = 5), fill = "red", alpha = 0.2) +
geom_hex(data = cyclones_data, aes(x = long, y = lat, fill = category), bins = 50, alpha = 0.7) +
scale_fill_viridis_d(name = "Storm Category") +
labs(
title = "North Atlantic and Northeast Pacific Cyclones by Category",
x = "Longitude",
y = "Latitude"
) +
scale_x_continuous(breaks = c(-180, -90, 0, 90, 180)) +
scale_y_continuous(breaks = c(-90, -45, 0, 45, 90)) +
theme_minimal()
cyclone_affected <- climate_awareness |>
filter(country %in% countries_with_cyclone$country) |>
left_join(countries_with_cyclone, by = "country") |>
rename(cyclone_count = count) |>
mutate(affected = "Affected")
# Weight the cyclone_affected data by cyclone_count for each awareness level
weighted_cyclone_affected <- cyclone_affected |>
summarise(
aware_no = sum(aware_no * cyclone_count) / sum(cyclone_count),
aware_alittle = sum(aware_alittle * cyclone_count) / sum(cyclone_count),
aware_moderate = sum(aware_moderate * cyclone_count) / sum(cyclone_count),
aware_alot = sum(aware_alot * cyclone_count) / sum(cyclone_count),
aware_refuse = sum(aware_refuse * cyclone_count) / sum(cyclone_count)
)
cyclone_unaffected <- climate_awareness |>
filter(country %in% countries_without_cyclone$country) |>
mutate(affected = "Unaffected")
(world_cyclone <- bind_rows(
weighted_cyclone_affected |>
mutate(affected = "Affected"),
cyclone_unaffected |>
summarise(across(where(is.numeric), mean, na.rm = TRUE)) |>
mutate(affected = "Unaffected")
))
world_cyclone_long <- world_cyclone |>
pivot_longer(cols = c(aware_no, aware_alittle, aware_moderate, aware_alot, aware_refuse),
names_to = "awareness_level", values_to = "value") |>
mutate(awareness_level = factor(awareness_level,
levels = c("aware_alot", "aware_moderate", "aware_alittle", "aware_no", "aware_refuse"),
labels = c("Aware", "Moderately Aware", "Aware a Little", "Not Aware", "Refuse")))
ggplot(world_cyclone_long, aes(x = awareness_level, y = value, fill = affected)) +
geom_bar(stat = "identity", position = "dodge") +
labs(x = "Awareness Category", y = "Awareness Level", fill = "Cyclone Impact",
title = "Comparison of Awareness Levels Between Cyclone-Affected and Unaffected") +
theme_minimal()
